---
layout: post
title: "ç†è§£è‹¹æœARKit 1å’Œ2"
date: '2019-04-25 18:34:33'
comments: true
---

[DEMO](https://github.com/Andrewmika/ARKitSwiftDemo)
åŒ…å«åŠŸèƒ½å¹³é¢æ£€æµ‹ã€ç¯å¢ƒçº¹ç†ã€ç‰©ä½“æ“ä½œï¼ˆæ·»åŠ ã€é€‰ä¸­ã€æ‹–åŠ¨ã€ç¼©æ”¾ã€æ—‹è½¬ï¼‰ã€å›¾åƒè¯†åˆ«ã€ç¯å¢ƒéŸ³æ•ˆ

# ä»€ä¹ˆæ˜¯ARKit
`ARï¼ˆAugmented Realityï¼‰`è¿ç”¨è®¡ç®—æœºæŠ€æœ¯ï¼Œå°†è™šæ‹Ÿçš„ä¿¡æ¯åº”ç”¨åˆ°çœŸå®ä¸–ç•Œï¼Œè¢«äººç±»æ„Ÿå®˜æ‰€æ„ŸçŸ¥ã€‚ç»™äººä¸€ç§è™šæ‹Ÿç‰©ä½“å­˜åœ¨äºç°å®ä¸–ç•Œçš„**é”™è§‰**ã€‚è€Œ`ARKit`æ•´åˆè¿åŠ¨ä¼ æ„Ÿå™¨æ•°æ®ï¼Œç›¸æœºæ•°æ®ï¼Œç›¸æœºæ•æ‰åˆ°çš„å›¾åƒåˆ†ææ•°æ®ï¼Œç”¨äºå»ºç«‹ç°å®åœºæ™¯å’Œå»ºæ¨¡ARå†…å®¹çš„è™šæ‹Ÿåœºæ™¯çš„å¯¹åº”å…³ç³»ï¼Œä¸ºè¿™ç§é”™è§‰æä¾›æ•°æ®åŸºç¡€ï¼Œç®€åŒ–æ„å»ºARä½“éªŒã€‚

# æ„å»ºARä½“éªŒçš„ä¸‰é©¾é©¬è½¦

## Tracking
é€šè¿‡Trackingï¼Œæˆ‘ä»¬å¯ä»¥ï¼š
- è·å¾—ç›¸æœºåœ¨ç°å®ä¸–ç•Œä¸­çš„ä½ç½®ã€‚
- å°†ç›¸æœºå›¾åƒå’Œè¿åŠ¨æ•°æ®æ•´åˆï¼Œå½¢æˆARè§†å›¾ã€‚
- è¿½è¸ªç‰¹å¾ç‚¹ï¼Œæ„å»ºARåœºæ™¯ã€‚è¿½è¸ªäººè„¸ï¼Œå›¾åƒï¼Œç‰©ä½“ç­‰ã€‚

ARè¿½è¸ªçš„å•ä½ä¸º**m**ã€‚å› æ­¤åœ¨åˆ¶ä½œARæ¨¡å‹æ—¶ï¼Œéœ€è¦æŒ‰ç…§ç‰©ä½“å®é™…åœ¨ç°å®ä¸–ç•Œä¸­çš„å±‹é‡Œæ¯”ä¾‹æ¥åˆ¶ä½œã€‚è¿™æ ·ç‰©ä½“ä¸è‡³äºè¿‡å¤§æˆ–è¿‡å°ï¼Œå‘ˆç°ä¼šæ›´çœŸå®ã€‚
åœ¨iOSå¼€å‘ä¸­ï¼ŒTrackingé€šè¿‡`AVFoundation`æ¥è·å–åœºæ™¯å›¾åƒï¼Œ`CoreMotion`æ¥è·å–è¿åŠ¨æ•°æ®ã€‚ç»“åˆä¸¤è€…å½¢æˆARè§†å›¾ã€‚

### Trackingè´¨é‡
è¦ä¿è¯é«˜è´¨é‡çš„è¿½è¸ªTrackingæ•°æ®ï¼Œéœ€è¦é«˜è´¨é‡çš„ç‰¹å¾ç‚¹ã€‚éœ€è¦æ»¡è¶³ä»¥ä¸‹æ¡ä»¶ï¼š
- æŒç»­çš„ç›¸æœºæ•°æ®å’Œä¼ æ„Ÿå™¨æ•°æ®
- ç¯å¢ƒçº¹ç†è¦è¶³å¤Ÿæ˜æ˜¾ã€‚éœ€è¦å¤„äºä¸€ä¸ªå…‰çº¿å……è¶³å¹¶ä¸”çº¹ç†æ˜æ˜¾çš„ç¯å¢ƒå½“ä¸­ï¼Œè¿™æ ·ARKitæ›´å®¹æ˜“æå–ç‰¹å¾ç‚¹ï¼Œå»ºç«‹ç©ºé—´å¯¹åº”å…³ç³»ã€‚
- é™æ€åœºæ™¯ã€‚åŠ¨æ€åœºæ™¯ä¼šå¯¼è‡´è§†è§‰æ•°æ®å’Œè¿åŠ¨æ•°æ®ä¸ç›¸ç¬¦ï¼Œå½±å“è¿½è¸ªè´¨é‡ã€‚

## Scene Understanding

- å¹³é¢æ£€æµ‹
- hit-testing
- å…‰çº¿ä¼°è®¡

## Rendering
å¯¹iOSå¼€å‘è€…æ¥è¯´ï¼Œæœ€ä¾¿æ·çš„æ¸²æŸ“æ–¹å¼æ˜¯`SceneKit`ã€‚ARKitè´Ÿè´£æ”¶é›†æ•°æ®ï¼Œæ¸²æŸ“è´Ÿè´£å±•ç¤ºARæ¨¡å‹ã€‚
æ”¯æŒçš„æ¸²æŸ“æ–¹å¼å¦‚ä¸‹ï¼š
- SceneKit
- SpringKit
- OpenGL/Metal


**ä¸‹é¢è¿™å¹…å›¾å±•ç¤ºäº†`ARKit`åœ¨ä¸€ä¸ªARåº”ç”¨ä¸­çš„è§’è‰²ã€‚**

![ARKitè§’è‰²](https://i.loli.net/2019/04/25/5cc1a97ea1847.png)

# ä¸‰æ­¥åˆ›å»ºä½ è‡ªå·±çš„ARä½“éªŒ
åˆ›å»ºARä½“éªŒåªéœ€è¦ä¸‰æ­¥ï¼š
![IMAGE](https://i.loli.net/2019/04/25/5cc1a9c8cc009.jpg)

`ARSession`é€šè¿‡`ARSessionConfiguration`å¼€å¯ï¼Œç”±Delegateå›è°ƒ`ARFrame`ä¿¡æ¯æ•°æ®è¿›è¡Œå±•ç¤ºã€‚

ç›¸å…³ä»£ç å¦‚ä¸‹ï¼š

åˆå§‹åŒ–Configuration
```
// Start the view's AR session with a configuration that uses the rear camera,
// device position and orientation tracking, and plane detection.
let configuration = ARWorldTrackingConfiguration()
configuration.planeDetection = [.horizontal, .vertical]
```

è¿è¡ŒARSession
```
sceneView.session.run(configuration)
```

è·å–å§”æ‰˜æ•°æ®ã€‚ps:å¦‚æœä½¿ç”¨`SceneKit`æ¥æ¸²æŸ“ï¼Œåˆ™ä¸ç”¨å…³å¿ƒSessionå›è°ƒï¼Œåªéœ€è¦å…³å¿ƒ`SceneKit`çš„`Node`ç›¸å…³æ“ä½œå’Œå›è°ƒã€‚
```
// Access the latest frame
func session(_: ARSession, didUpdate: ARFrame)
```
æ¥ä¸‹æ¥æˆ‘ä»¬å°±æ¥äº†è§£ä¸€ä¸‹`ARKit`ä¸­å‡ ä¸ªé‡è¦çš„ç±»ã€‚

## ARSession
ARä½“éªŒé€šè¿‡`ARSession`æ¥å¼€å¯ã€‚å®ƒç®¡ç†ç€Trackingæ—¶æ‰€æœ‰çš„è¿›ç¨‹ï¼Œæ˜¯ç®¡ç†è®¾å¤‡ç›¸æœºå’ŒåŠ¨ä½œå¤„ç†çš„å…±äº«å¯¹è±¡ã€‚`ARSession`æ•´åˆè¿åŠ¨ä¼ æ„Ÿå™¨æ•°æ®ï¼Œç›¸æœºæ•°æ®ï¼Œç›¸æœºæ•æ‰åˆ°çš„å›¾åƒåˆ†ææ•°æ®ï¼Œç”¨äºå»ºç«‹è®¾å¤‡æ‰€åœ¨åœºæ™¯å’Œå»ºæ¨¡ARå†…å®¹çš„è™šæ‹Ÿåœºæ™¯çš„å¯¹åº”å…³ç³»ã€‚
æ¯ä¸€ä¸ªAR ä½“éªŒéƒ½éœ€è¦ä¸€ä¸ª`ARSession`å¯¹è±¡ã€‚å¦‚æœä½¿ç”¨`ARSCNView`æˆ–è€…`ARSKView`æ¥æ¸²æŸ“å±•ç¤ºéƒ¨åˆ†ï¼ŒViewå¯¹è±¡åŒ…å«ä¸€ä¸ª`ARSession`å®ä¾‹ã€‚å¦‚æœä½¿ç”¨ä½ è‡ªå·±çš„æ¸²æŸ“å™¨ï¼Œä½ éœ€è¦å®ä¾‹åŒ–å¹¶ç»´æŠ¤ä¸€ä¸ª`ARSession`å¯¹è±¡ã€‚

`ARSession`å¯¹è±¡éœ€è¦é€šè¿‡`ARConfiguration`å­ç±»æ¥è¿è¡Œï¼Œè¿™ä¸ªé…ç½®å†³å®šARKitå¦‚ä½•è¿½è¸ªè®¾å¤‡ç›¸å¯¹äºç°å®åœºæ™¯ä¸­çš„ä½ç½®åŠåŠ¨ä½œã€‚

```
/**
     Runs the session with the provided configuration and options.
     @discussion Calling run on a session that has already started will
     transition immediately to using the new configuration. Options
     can be used to alter the default behavior when transitioning configurations.
     @param configuration The configuration to use.
     @param options The run options to use.
*/
open func run(_ configuration: ARConfiguration, options: ARSession.RunOptions = [])

```

## ARConfiguration
`ARSession`ç”±`ARConfiguration`**å­ç±»**æ¥å¼€å¯ã€‚ä¸åŒConfigurationæœ‰ä¸åŒçš„ç‰¹æ€§ï¼Œéƒ½æ˜¯é€šè¿‡ç¯å¢ƒä¸­çš„**ç‰¹å¾ç‚¹**æ¥è¿›è¡Œè¿½è¸ªã€‚

### ARWorldTrackingConfiguration - iOS 11.0+ - 6DOF
ä½¿ç”¨åç½®æ‘„åƒå¤´ç²¾ç¡®è·Ÿè¸ªè®¾å¤‡çš„ä½ç½®å’Œæ–¹å‘ï¼Œå¹¶å…è®¸å¹³é¢æ£€æµ‹ã€hit-testingã€åŸºäºç¯å¢ƒçš„å…‰çº¿ä¼°è®¡ã€ä»¥åŠå›¾åƒå’Œå¯¹è±¡æ£€æµ‹è¿½è¸ªã€‚
ARKitä½¿ç”¨**è§†è§‰æƒ¯æ€§æµ‹é‡æ³•ï¼ˆvisual-inertial odometryï¼‰**åœ¨çœŸå®å’Œè™šæ‹Ÿç©ºé—´ä¹‹é—´å»ºç«‹å¯¹åº”å…³ç³»ã€‚

#### åŠŸèƒ½
- `planeDetection`ï¼šæŸ¥æ‰¾ç°å®å¹³é¢ï¼ˆæ°´å¹³æˆ–ç«–ç›´ï¼‰ï¼Œå¹¶ä½œä¸º`ARPlaneAnchor`å¯¹è±¡æ¥æ·»åŠ åˆ°ä¼šè¯ä¸­ã€‚
- `detectionImages`ï¼šè¯†åˆ«2Då›¾åƒå¹¶è¿½è¸ªå›¾åƒçš„ç§»åŠ¨ï¼Œå¹¶ä½œä¸º`ARImageAnchor`å¯¹è±¡æ·»åŠ åˆ°åœºæ™¯ä¸­ã€‚
- `detectionObjects`ï¼šè¯†åˆ«3Då¯¹è±¡ï¼Œå¹¶ä½œä¸º`ARObjectAnchor`å¯¹è±¡æ·»åŠ åˆ°åœºæ™¯ä¸­ã€‚
- `environmentTexturing`ï¼šå…‰é¢ç‰©ä½“ä¸Šå±•ç¤ºç¯å¢ƒçº¹ç†ã€‚
- åœ¨`ARFrame`,`ARSCNView`æˆ–è€…`ARSKView`ä¸­é€šè¿‡`hit-testing`æ¥æŸ¥æ‰¾ä¸ç›¸æœºåœºæ™¯çš„2Dåæ ‡å¯¹åº”çš„ç°å®ä¸–ç•Œä¸­çš„ä½ç½®ã€‚

æœ€ä½³å®è·µï¼š
- åœ¨å¯é çš„ç…§æ˜æ¡ä»¶ä¸­è®¾è®¡ARä½“éªŒã€‚ä¸–ç•Œè¿½è¸ªéœ€è¦æ¸…æ™°çš„å›¾åƒæ¥è¿›è¡Œå›¾åƒåˆ†æã€‚å¦‚æœç»†èŠ‚ä¸æ¸…æ™°ï¼Œè¿½è¸ªæ•ˆæœå°†ä¼šé™ä½ã€‚æ¯”å¦‚ï¼Œç›¸æœºå¯¹ç€ç©ºç™½å¢™é¢æˆ–è€…å¤„äºå…‰çº¿ä¸è¶³çš„åœºæ™¯ä¸­æ—¶ã€‚
- æ ¹æ®è¿½è¸ªä¿¡æ¯æ¥æä¾›ç”¨æˆ·åé¦ˆã€‚ä¸–ç•Œè¿½è¸ªå°†å›¾åƒåˆ†æä¸è®¾å¤‡è¿åŠ¨å…³è”ã€‚å¦‚æœè®¾å¤‡æ­£åœ¨ç§»åŠ¨ï¼ŒARKitä¼šæ›´å¥½åœ°ç†è§£åœºæ™¯ã€‚ä½†è¿‡åº¦çš„è¿åŠ¨åˆä¼šé™ä½è¿½è¸ªè´¨é‡ã€‚`ARCamera`ç±»æä¾›è¿½è¸ªçŠ¶æ€çš„åŸå› ä¿¡æ¯ï¼Œå¯ä»¥ä½¿ç”¨æ­¤ä¿¡æ¯æ¥è¿›è¡Œ**UIå±•ç¤º**ã€‚
- ç•™å‡ºæ—¶é—´è¿›è¡Œå¹³é¢æ£€æµ‹ï¼Œå¹¶åœ¨è·å¾—æ‰€éœ€ç»“æœæ—¶ç¦ç”¨å¹³é¢æ£€æµ‹ã€‚å¹³é¢æ£€æµ‹ç»“æœæ˜¯ä¸€ä¸ªå‡¸å¤šè¾¹å½¢ï¼Œä¼šéšç€æ£€æµ‹ç»“æœä¸æ–­å˜åŒ–ã€‚

### AROrientationTrackingConfiguration - iOS 11.0+ - 3DOF
æä¾›åŸºæœ¬ARä½“éªŒã€‚ä½¿ç”¨åç½®æ‘„åƒå¤´è·Ÿè¸ªè®¾å¤‡æ–¹å‘ã€‚

### ARFaceTrackingConfiguration - iOS 11.0+
æä¾›ä½¿ç”¨å‰ç½®æ‘„åƒå¤´çš„ARä½“éªŒï¼Œå¹¶è·Ÿè¸ªç”¨æˆ·è„¸éƒ¨æ‹“æ‰‘å’Œè¡¨æƒ…ã€‚
æ£€æµ‹åˆ°äººè„¸ä¼šè¿”å›ä¸€ä¸ª`ARFaceAnchor`å¯¹è±¡ã€‚å…¶ä¸­çš„ä¿¡æ¯åŒ…æ‹¬åŒ…å¤´éƒ¨å§¿åŠ¿ï¼Œè„¸éƒ¨ç½‘æ ¼æ‹“æ‰‘ï¼Œçœ¼çƒè¿½è¸ªä¿¡æ¯å’Œæ··åˆå½¢çŠ¶çš„ä¿¡æ¯**ç³»æ•°**ã€‚å¦‚æœå¯ç”¨å…‰ä¼°è®¡ï¼Œåˆ™ä¼šä¼°è®¡å…‰çº¿æ–¹å‘ã€‚

å¼€å¯ä¼šè¯ï¼š
```
guard ARFaceTrackingConfiguration.isSupported else { return }
let configuration = ARFaceTrackingConfiguration()
configuration.isLightEstimationEnabled = true
sceneView.session.run(configuration, options: [.resetTracking, .removeExistingAnchors])

```

- `ARFaceTrackingConfiguration`ï¼šä½¿ç”¨TrueDepthç›¸æœºè¿½è¸ªè„¸éƒ¨åŠ¨ä½œå’Œè¡¨æƒ…
- `ARFaceAnchor`ï¼šåŒ…å«è„¸éƒ¨å§¿åŠ¿ï¼Œæ‹“æ‰‘ï¼Œè¡¨æƒ…ä¿¡æ¯ã€‚å¦‚æœæœ‰å¤šå¼ è„¸ï¼ŒARKitä¼šæ—‹è½¬æœ€å¤§çš„æˆ–æœ€æ¸…æ™°çš„æ¥è¯†åˆ«ã€‚
- `ARSCNFaceGeometry`
- `ARDirectionalLightEstimate`ï¼š æ¨¡æ‹Ÿç¯å¢ƒå…‰ç…§ä¿¡æ¯


### ARImageTrackingConfiguration - iOS 12.0+ - 6DOF
ä½¿ç”¨åç½®æ‘„åƒå¤´æ¥è¿½è¸ªå·²çŸ¥å›¾åƒï¼Œæœ€å¤šå¯åŒæ—¶æœ€ç»ˆ4å¼ å›¾åƒã€‚

![IMAGE](https://i.loli.net/2019/04/25/5cc1aa021a21b.jpg)

é€šè¿‡åœ¨Asset catalogä¸­åˆ›å»ºAR Resource Groupï¼Œå¯¼å…¥éœ€è¦è¯†åˆ«çš„å›¾åƒï¼Œæ¥è¿›è¡Œæ£€æµ‹ã€‚Groupä¸­æœ€å¤šå¯å¯¼å…¥25å¼ å›¾ç‰‡ã€‚

åœ¨é€‰æ‹©å›¾åƒæ—¶æœ‰å‡ ç‚¹è¦æ±‚ï¼š
- ä¸ºæ¯å¼ å›¾åƒæŒ‡å®šå‡†ç¡®ç‰©ç†å°ºå¯¸ã€‚ARKité€šè¿‡è¿™ä¸ªç‰©ç†å°ºå¯¸å†³å®šå›¾åƒä¸é•œå¤´çš„è·ç¦»ã€‚
- ç‰¹å¾ç‚¹æ˜æ˜¾ï¼Œå¯¹æ¯”åº¦é«˜ã€‚åˆ©äºè¯†åˆ«ã€‚
- é¿å…åå…‰æè´¨ç­‰ä¼šå¹²æ‰°è§†è§‰å›¾åƒçš„å› ç´ ã€‚

example:
```
guard let referenceImages = ARReferenceImage.referenceImages(inGroupNamed: "AR Resources", bundle: nil) else {
    fatalError("Missing expected asset catalog resources.")
}

let configuration = ARWorldTrackingConfiguration()
configuration.detectionImages = referenceImages
session.run(configuration, options: [.resetTracking, .removeExistingAnchors])
```

- `ARReferenceImage`: åœ¨ç°å®ä¸–ç•Œç¯å¢ƒä¸­è¢«è¯†åˆ«çš„å›¾åƒã€‚
- `ARImageAnchor`ï¼šåŒ…å«æ£€æµ‹åˆ°çš„å›¾åƒçš„ä½ç½®å’Œæ–¹å‘ä¿¡æ¯ã€‚

#### æœ€ä½³å®è·µ
- ä½¿ç”¨æ£€æµ‹åˆ°çš„å›¾åƒæ¥è®¾ç½®ARåœºæ™¯çš„å‚è€ƒç³»
- ä½¿ç”¨æ£€æµ‹åˆ°çš„å›¾åƒä½œä¸ºè™šæ‹Ÿå†…å®¹çš„èµ·ç‚¹
- è€ƒè™‘ä½•æ—¶å…è®¸æ£€æµ‹åˆ°çš„å›¾åƒæ¥è§¦å‘äº¤äº’ï¼šæ£€æµ‹åˆ°å›¾åƒæ—¶ï¼Œæ“ä½œåªä¼šè§¦å‘ä¸€æ¬¡ã€‚è¦è§¦å‘å¤šæ¬¡å¯ä½¿ç”¨` removeAnchor:`åœ¨åˆé€‚çš„æ—¶é—´ä¸»åŠ¨ç§»é™¤ï¼Œä¸‹ä¸€æ¬¡æ£€æµ‹åˆ°å›¾åƒæ—¶ï¼ŒARKitä¼šæ·»åŠ ä¸€ä¸ªæ–°çš„anchor.

### ARObjectScanningConfiguration - iOS 12.0+ - 6DOF
æä¾›ä½¿ç”¨åç½®æ‘„åƒå¤´æ”¶é›†é«˜ä¿çœŸç©ºé—´æ•°æ®ï¼Œåˆ›å»ºå‚è€ƒå¯¹è±¡ä»¥ä¾¿åœ¨å…¶ä»–ARä½“éªŒä¸­è¿›è¡Œæ£€æµ‹ã€‚
é€šè¿‡åœ¨Asset catalogä¸­åˆ›å»ºAR Resource Groupï¼Œå¯¼å…¥éœ€è¦åŒ…å«è¯†åˆ«å¯¹è±¡ä¿¡æ¯çš„`.arobject`æ–‡ä»¶ï¼Œæ¥è¿›è¡Œæ£€æµ‹ã€‚

![IMAGE](https://i.loli.net/2019/04/25/5cc1aa3b3965d.jpg)

exampleï¼š
```
let configuration = ARWorldTrackingConfiguration()
guard let referenceObjects = ARReferenceObject.referenceObjects(inGroupNamed: "gallery", bundle: nil) else {
    fatalError("Missing expected asset catalog resources.")
}
configuration.detectionObjects = referenceObjects
sceneView.session.run(configuration)
```

- `ARReferenceObject`ï¼šè¦è¯†åˆ«çš„3Då¯¹è±¡
- `ARObjectAnchor`ï¼šæ£€æµ‹åˆ°çš„3Då¯¹è±¡çš„ä½ç½®å’Œæ–¹å‘ä¿¡æ¯ã€‚

### degrees of freedom
ä¸‹é¢è¿™å¹…å›¾å±•ç¤ºçš„æ˜¯6 degrees of freedomã€‚å…¶å®å°±æ˜¯åŒ…å«åœ¨ä¸‰ä½åæ ‡x, y, zä¸‰è½´ä¸Šçš„ä½ç½®ï¼ˆåœ¨è½´ä¸Šå¹³ç§»ï¼‰å’Œæ–¹å‘ï¼ˆç»•è½´æ—‹è½¬ï¼‰ã€‚
![IMAGE](https://i.loli.net/2019/04/25/5cc1aa8663e62.jpg)


## ARFrame
æ¯ä¸€ä¸ª`ARFrame`éƒ½åŒ…å«ä¸€ä¸ª`ARCameraï¼ˆè™šæ‹Ÿçš„ç›¸æœºå¯¹è±¡ï¼šåŒ…å«ä½ç½®å’Œæˆåƒç‰¹å¾çš„ä¿¡æ¯ï¼‰`
`ARFrame`åŒ…å«å¦‚ä¸‹ä¿¡æ¯ï¼š
- å¸¦æœ‰ä½ç½®è¿½è¸ªä¿¡æ¯çš„è§†é¢‘å›¾åƒ
- è¿½è¸ªçš„ä¿¡æ¯å’ŒçŠ¶æ€
- åœºæ™¯ä¿¡æ¯

## ARHitTestResult
åŒ…å«é€šè¿‡æ£€æŸ¥ARä¼šè¯çš„è®¾å¤‡æ‘„åƒæœºè§†å›¾ä¸­çš„ç‚¹æ‰¾åˆ°æœ‰å…³çœŸå®ä¸–ç•Œè¡¨é¢çš„ä¿¡æ¯ã€‚

## ARAnchor
é”šç‚¹ï¼Œè¿™ä¸ªå¤§å®¶éƒ½æ¯”è¾ƒå¥½ç†è§£ã€‚
æˆ‘ä»¬å¦‚æœè¦åœ¨ç°å®ä¸–ç•Œä¸­æŒ‚ä¸€å¹…ç”»è¦æ€ä¹ˆåšå‘¢ï¼Ÿå¤§è‡´åªéœ€è¦ä¸¤æ­¥ã€‚
1. æ‰¾åˆ°æˆ‘ä»¬è¦æŒ‚ç”»çš„**ä½ç½®**ï¼Œå®šä¸€ä¸ªé’‰å­ï¼ˆä¸‹ä¸ªé”šç‚¹ï¼‰
2. æŠŠä½ çš„ç”»ï¼ˆè™šæ‹Ÿç‰©ä½“ï¼‰ï¼ŒæŒ‚ä¸Šå»


ç‰¹ç‚¹ï¼š
- ç‰©ç†ä¸–ç•Œä¸­çš„ç‚¹ï¼Œç”¨äºæ”¾ç½®è™šæ‹Ÿç‰©ä½“ã€‚
- åŒ…å«ç°å®ä¸–ç•Œä½ç½®å’Œæ–¹å‘
- é€šè¿‡ARSessionæ·»åŠ å’Œåˆ é™¤
- æœ‰ä¸°å¯Œçš„å­ç±»ï¼ŒåŒ…å«ä¸åŒçš„anchorä¿¡æ¯ï¼Œ æˆ–è‡ªå®šä¹‰anchor
- é€šè¿‡ARSessionDelegateæ›´æ–° add/update/remove

## SceneKitç›¸å…³
äº†è§£äº†ARKitçš„æ“ä½œï¼Œä¸‹ä¸€æ­¥å°±è¦è¿›è¡Œæ¸²æŸ“ã€‚SceneKitè´Ÿè´£æ‰€æœ‰è™šæ‹Ÿç‰©ä½“çš„æ¸²æŸ“ã€‚è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨`ARSCNView`,å®ƒçš„ä¸»è¦åŠŸèƒ½å¦‚ä¸‹
- ç»˜åˆ¶æ•æ‰çš„å›¾åƒ
- æ›´æ–°SCNCamera
- æ›´æ–°åœºæ™¯å…‰çº¿
- **æ˜ å°„SCNNodesåˆ°ARAchors**

![IMAGE](https://i.loli.net/2019/04/25/5cc1aaa57540a.jpg)

SceneKitä¼šæŠŠ`ARAnchor`ä¸`SCNNode`å¯¹åº”ã€‚æˆ‘ä»¬è¦æ“ä½œè™šæ‹Ÿç‰©ä½“æ—¶ï¼Œåªéœ€è¦æ“ä½œSceneä¸–ç•Œä¸­çš„`Node`.æˆ‘ä»¬å…³æ³¨çš„ä¹Ÿéƒ½æ˜¯`ARSCNViewDelegate`çš„å›è°ƒã€‚

### ç¯å¢ƒéŸ³æ•ˆ
å¯ä»¥ä½¿ç”¨`SceneKit`çš„node-based audio APIç»™ç‰©ä½“æ·»åŠ å£°éŸ³ã€‚å¦‚æœéœ€è¦ç¯å¢ƒéŸ³æ•ˆæ•ˆæœï¼Œéœ€è¦ä½¿ç”¨**å•å£°é“**éŸ³é¢‘ã€‚

exampleï¼š
```
// MARK: - Sound
    /// Sets up the audio for playback.
    /// - Tag: SetUpAudio
    private func setUpAudio() {
        // Instantiate the audio source
        audioSource = SCNAudioSource(fileNamed: "fireplace.mp3")!
        // As an environmental sound layer, audio should play indefinitely
        audioSource.loops = true
        // Decode the audio from disk ahead of time to prevent a delay in playback
        audioSource.load()
    }
    /// Plays a sound on the `objectNode` using SceneKit's positional audio
    /// - Tag: AddAudioPlayer
    private func playSound() {
        // Ensure there is only one audio player
        objectNode.removeAllAudioPlayers()
        // Create a player from the source and add it to `objectNode`
        objectNode.addAudioPlayer(SCNAudioPlayer(source: audioSource))
    }
```

## ARKit 2æ–°ç‰¹æ€§

### ç©ºé—´æ˜ å°„çš„å­˜å‚¨å’Œå…±äº«
æ–°å¢äº†`ARWorldMap`ï¼ŒåŒ…å«æ˜ å°„ä¿¡æ¯ã€‚å¯ä»¥ä¿å­˜åœºæ™¯çš„çŠ¶æ€ï¼Œè¿›è¡Œ**åœºæ™¯å…±äº«**ã€‚
![IMAGE](https://i.loli.net/2019/04/25/5cc1aac2e7f98.jpg)

### World Tracking Enhancements
- ä¿å­˜/åŠ è½½æ˜ å°„
- æ›´å¿«çš„åˆå§‹åŒ–å’Œå¹³é¢æ£€æµ‹
- æ£€æµ‹æ›´ç²¾å‡†
- è¿ç»­å¯¹ç„¦
- 4:3è§†é¢‘æ ¼å¼ï¼Œ ARKit2çš„é»˜è®¤æ ¼å¼

### Environment Texturing
å¯ä»¥åœ¨å…‰é¢ç‰©ä½“ä¸Šåå°„ç¯å¢ƒçº¹ç†ï¼Œè®©ç‰©ä½“æ›´é€¼çœŸã€‚

### Image Tracking
æŸ¥é˜…`ARImageTrackingConfiguration`ã€‚

### Object Detection
æŸ¥é˜…`ARObjectScanningConfiguration`ã€‚

### Face Tracking Enhancements
æ–°å¢çœ¼çƒğŸ‘€å’ŒèˆŒå¤´ğŸ˜è¿½è¸ª

## æ¨èé˜…è¯»
[å®˜æ–¹æ‰‹å†Œ](https://developer.apple.com/documentation/arkit)
[Introducing ARKit: Augmented Reality for iOS](https://developer.apple.com/videos/play/wwdc2017/602/)
[Face Tracking with ARKit](https://developer.apple.com/videos/play/tech-talks/601/)
[Whatâ€™s New in ARKit 2](https://developer.apple.com/videos/play/wwdc2018/602/)
[Understanding ARKit Tracking and Detection](https://developer.apple.com/videos/play/wwdc2018/610/)